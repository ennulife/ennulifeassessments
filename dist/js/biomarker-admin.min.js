document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".nav-tab");e.forEach(function(t){t.addEventListener("click",function(t){t.preventDefault();var n=this.getAttribute("href");e.forEach(function(e){return e.classList.remove("nav-tab-active")}),this.classList.add("nav-tab-active"),document.querySelectorAll(".tab-content").forEach(function(e){return e.classList.remove("active")});var r=document.querySelector(n);r&&r.classList.add("active")})}),document.querySelectorAll('input[name="import_method"]').forEach(function(e){e.addEventListener("change",function(){var e=document.querySelector(".csv-upload-row"),t=document.querySelector(".manual-entry-section");"csv"===this.value?(e&&(e.style.display="block"),t&&(t.style.display="none")):(e&&(e.style.display="none"),t&&(t.style.display="block"))})});var t=document.getElementById("add-biomarker-entry");t&&t.addEventListener("click",function(){var e=document.querySelector(".biomarker-entry");if(e){var t=e.cloneNode(!0);t.querySelectorAll("input, select").forEach(function(e){return e.value=""});var n=document.getElementById("biomarker-entries");n&&n.appendChild(t)}}),document.addEventListener("click",function(e){if(e.target.classList.contains("remove-biomarker-entry")&&document.querySelectorAll(".biomarker-entry").length>1){var t=e.target.closest(".biomarker-entry");t&&t.remove()}});var n=document.getElementById("ennu-lab-import-form");n&&n.addEventListener("submit",function(e){e.preventDefault();var t=new FormData(this);t.append("action","ennu_import_lab_data"),t.append("nonce",ennuBiomarkerAdmin.nonce);var n=this.querySelector('input[type="submit"]'),r=n.value;n.value="Importing...",n.disabled=!0,fetch(ennuBiomarkerAdmin.ajaxurl,{method:"POST",body:t}).then(function(e){return e.json()}).then(function(e){e.success?(o("success",e.data.message),e.data.errors&&e.data.errors.length>0&&o("error","Some errors occurred: "+e.data.errors.join(", "))):o("error",e.data.message||"Import failed")}).catch(function(){o("error","Network error occurred")}).finally(function(){n.value=r,n.disabled=!1})});var r=document.getElementById("targets-user-select");r&&r.addEventListener("change",function(){var e=this.value,t=document.getElementById("doctor-targets-section");e?(function(e){var t=document.getElementById("targets-container");t&&(t.innerHTML='<div class="loading-spinner"></div>');var n=new FormData;n.append("action","ennu_get_user_biomarkers"),n.append("user_id",e),n.append("nonce",ennuBiomarkerAdmin.nonce),fetch(ennuBiomarkerAdmin.ajaxurl,{method:"POST",body:n}).then(function(e){return e.json()}).then(function(e){e.success?function(e,t){var n="";if(e&&Object.keys(e).length>0)for(var r in e){var a=e[r],o=t[r]||"";n+='<div class="target-input-group">',n+="<label>"+(a.name||r.replace(/_/g," "))+" ("+(a.unit||"")+")</label>",n+='<input type="number" step="0.01" name="targets['+r+']" value="'+o+'" placeholder="Target value">',n+='<span class="current-value">Current: '+(a.value||"N/A")+"</span>",n+="</div>"}else n="<p>No biomarker data found for this user. Import lab data first.</p>";var c=document.getElementById("targets-container");c&&(c.innerHTML=n)}(e.data.biomarkers,e.data.targets):t&&(t.innerHTML="<p>Error loading biomarkers</p>")}).catch(function(){t&&(t.innerHTML="<p>Network error occurred</p>")})}(e),t&&(t.style.display="block")):t&&(t.style.display="none")});var a=document.getElementById("ennu-doctor-targets-form");function o(e,t){var n="success"===e?"success-message":"error-message",r='<div class="'+n+'">'+t+"</div>",a=document.querySelector(".wrap");a&&(a.insertAdjacentHTML("afterbegin",r),setTimeout(function(){var e=document.querySelector("."+n);e&&(e.style.opacity="0",e.style.transition="opacity 0.3s",setTimeout(function(){return e.remove()},300))},5e3))}a&&a.addEventListener("submit",function(e){e.preventDefault();var t=new FormData(this);t.append("action","ennu_save_doctor_targets"),t.append("nonce",ennuBiomarkerAdmin.nonce);var n=this.querySelector('input[type="submit"]'),r=n.value;n.value="Saving...",n.disabled=!0,fetch(ennuBiomarkerAdmin.ajaxurl,{method:"POST",body:t}).then(function(e){return e.json()}).then(function(e){e.success?o("success",e.data.message):o("error",e.data.message||"Save failed")}).catch(function(){o("error","Network error occurred")}).finally(function(){n.value=r,n.disabled=!1})})});
//# sourceMappingURL=biomarker-admin.min.js.map