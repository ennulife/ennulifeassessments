(()=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?n(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=Array(e);n<e;n++)a[n]=t[n];return a}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,s(a.key),a)}}function o(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,n||"default");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}var r=function(){return o(function t(){a(this,t),this.originalGoals=new Set,this.currentGoals=new Set,this.updateButton=null,this.notificationSystem=new l,this.isUpdating=!1,this.init()},[{key:"init",value:function(){var t=this;"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){return t.initialize()}):this.initialize()}},{key:"initialize",value:function(){this.cacheOriginalGoals(),this.setupEventListeners(),this.createUpdateButton(),this.addGoalAttributes()}},{key:"cacheOriginalGoals",value:function(){var t=this;document.querySelectorAll(".goal-pill.selected").forEach(function(e){var n=t.extractGoalId(e);n&&(t.originalGoals.add(n),t.currentGoals.add(n))})}},{key:"extractGoalId",value:function(t){if(t.dataset.goalId)return t.dataset.goalId;var e=t.querySelector(".goal-pill-text");if(e){var n=e.textContent.trim().toLowerCase();return this.textToGoalId(n)}return null}},{key:"textToGoalId",value:function(t){return{"weight loss":"weight_loss","muscle gain":"strength","energy boost":"energy","better sleep":"sleep","stress reduction":"stress","skin improvement":"aesthetics","hair health":"aesthetics","hormone balance":"hormonal_balance","sexual health":"libido","menopause support":"hormonal_balance","immune boost":"longevity","cognitive function":"cognitive_health","longevity & healthy aging":"longevity","improve energy & vitality":"energy","build strength & muscle":"strength","enhance libido & sexual health":"libido","achieve & maintain healthy weight":"weight_loss","hormonal balance":"hormonal_balance","sharpen cognitive function":"cognitive_health","support heart health":"heart_health","improve hair, skin & nails":"aesthetics","improve sleep quality":"sleep","reduce stress & improve resilience":"stress"}[t]||t.replace(/[^a-z]/g,"_")}},{key:"addGoalAttributes",value:function(){var t=this;document.querySelectorAll(".goal-pill").forEach(function(e){if(!e.dataset.goalId){var n=t.extractGoalId(e);n&&(e.dataset.goalId=n)}})}},{key:"setupEventListeners",value:function(){var t=this;document.addEventListener("click",function(e){if(e.target.classList.contains("goal-pill")||e.target.closest(".goal-pill")){var n=e.target.classList.contains("goal-pill")?e.target:e.target.closest(".goal-pill");t.handleGoalPillClick(n,e)}e.target.classList.contains("update-goals-button")&&(e.preventDefault(),t.handleUpdateGoalsClick())}),document.addEventListener("keydown",function(e){"Enter"!==e.key&&" "!==e.key||(e.target.classList.contains("goal-pill")&&(e.preventDefault(),t.handleGoalPillClick(e.target,e)),e.target.classList.contains("update-goals-button")&&(e.preventDefault(),t.handleUpdateGoalsClick()))})}},{key:"handleGoalPillClick",value:function(t,e){if(!this.isUpdating){var n=t.dataset.goalId;if(n){var a=t.classList.contains("selected");t.classList.toggle("selected"),t.classList.add("changed"),a?this.currentGoals.delete(n):this.currentGoals.add(n),this.checkForChanges(),this.addPillFeedback(t)}}}},{key:"addPillFeedback",value:function(t){t.style.transform="scale(1.05)",t.style.transition="transform 0.1s ease",setTimeout(function(){t.style.transform="scale(1)"},100),this.createRippleEffect(t)}},{key:"createRippleEffect",value:function(t){var e=document.createElement("span");e.className="goal-pill-ripple";var n=t.getBoundingClientRect(),a=Math.max(n.width,n.height);e.style.width=e.style.height=a+"px",e.style.left="50%",e.style.top="50%",e.style.transform="translate(-50%, -50%) scale(0)",t.style.position="relative",t.appendChild(e),requestAnimationFrame(function(){e.style.transform="translate(-50%, -50%) scale(1)",e.style.opacity="0"}),setTimeout(function(){e.parentNode&&e.parentNode.removeChild(e)},300)}},{key:"checkForChanges",value:function(){!this.setsEqual(this.originalGoals,this.currentGoals)?this.showUpdateButton():(this.hideUpdateButton(),this.clearChangedIndicators())}},{key:"setsEqual",value:function(t,n){return t.size===n.size&&e(t).every(function(t){return n.has(t)})}},{key:"createUpdateButton",value:function(){this.updateButton=document.createElement("button"),this.updateButton.className="update-goals-button",this.updateButton.setAttribute("type","button"),this.updateButton.setAttribute("tabindex","0"),this.updateButton.setAttribute("aria-label","Update your health goals"),this.updateButton.innerHTML='\n            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16" aria-hidden="true">\n                <path d="M20 6L9 17l-5-5"/>\n            </svg>\n            <span>Update My Health Goals</span>\n        ',this.updateButton.style.display="none";var t=document.querySelector(".health-goals-grid");t&&t.parentNode&&t.parentNode.insertBefore(this.updateButton,t.nextSibling)}},{key:"showUpdateButton",value:function(){var t=this;this.updateButton&&(this.updateButton.style.display="flex",this.updateButton.style.opacity="0",this.updateButton.style.transform="translateY(10px)",requestAnimationFrame(function(){t.updateButton.style.transition="all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)",t.updateButton.style.opacity="1",t.updateButton.style.transform="translateY(0)"}))}},{key:"hideUpdateButton",value:function(){var t=this;this.updateButton&&(this.updateButton.style.transition="all 0.3s ease",this.updateButton.style.opacity="0",this.updateButton.style.transform="translateY(10px)",setTimeout(function(){t.updateButton.style.display="none"},300))}},{key:"clearChangedIndicators",value:function(){document.querySelectorAll(".goal-pill.changed").forEach(function(t){t.classList.remove("changed")})}},{key:"handleUpdateGoalsClick",value:function(){var t=this;if(!this.isUpdating){this.isUpdating=!0;var e=Array.from(this.currentGoals);this.setUpdateButtonLoading(!0);var n=new FormData;n.append("action","ennu_update_health_goals"),"undefined"!=typeof ennuHealthGoalsAjax?(n.append("nonce",ennuHealthGoalsAjax.nonce),e.forEach(function(t){n.append("health_goals[]",t)}),fetch(ennuHealthGoalsAjax.ajax_url,{method:"POST",body:n}).then(function(t){return t.json()}).then(function(e){t.isUpdating=!1,t.setUpdateButtonLoading(!1),e.success?t.handleUpdateSuccess(e.data):t.handleUpdateError(e.data)}).catch(function(e){var n;t.isUpdating=!1,t.setUpdateButtonLoading(!1),t.handleUpdateError({message:(null===(n=ennuHealthGoalsAjax)||void 0===n||null===(n=n.messages)||void 0===n?void 0:n.network_error)||"Network error occurred"})})):(this.isUpdating=!1,this.setUpdateButtonLoading(!1),this.notificationSystem.show("Unable to update goals: AJAX configuration missing","error"))}}},{key:"setUpdateButtonLoading",value:function(t){var e;this.updateButton&&(t?(this.updateButton.disabled=!0,this.updateButton.innerHTML='\n                <div class="loading-spinner" aria-hidden="true"></div>\n                <span>'.concat((null===(e=ennuHealthGoalsAjax)||void 0===e||null===(e=e.messages)||void 0===e?void 0:e.updating)||"Updating Goals...","</span>\n            "),this.updateButton.classList.add("loading")):(this.updateButton.disabled=!1,this.updateButton.innerHTML='\n                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16" aria-hidden="true">\n                    <path d="M20 6L9 17l-5-5"/>\n                </svg>\n                <span>Update My Health Goals</span>\n            ',this.updateButton.classList.remove("loading")))}},{key:"handleUpdateSuccess",value:function(t){var e,n=t.message||(null===(e=ennuHealthGoalsAjax)||void 0===e||null===(e=e.messages)||void 0===e?void 0:e.success)||"Goals updated successfully!";this.notificationSystem.show(n,"success"),this.originalGoals=new Set(this.currentGoals),this.hideUpdateButton(),this.clearChangedIndicators(),t.redirect_needed&&(this.notificationSystem.show("Refreshing page to update your scores...","info",1500),setTimeout(function(){window.location.reload()},2e3))}},{key:"handleUpdateError",value:function(t){var e,n=(null==t?void 0:t.message)||(null===(e=ennuHealthGoalsAjax)||void 0===e||null===(e=e.messages)||void 0===e?void 0:e.error)||"Failed to update health goals";this.notificationSystem.show(n,"error"),this.revertVisualChanges()}},{key:"revertVisualChanges",value:function(){var t=this;this.currentGoals=new Set(this.originalGoals),document.querySelectorAll(".goal-pill").forEach(function(e){var n=e.dataset.goalId;if(n){var a=t.originalGoals.has(n);e.classList.toggle("selected",a),e.classList.remove("changed")}}),this.hideUpdateButton()}}])}(),l=function(){return o(function t(){a(this,t),this.container=this.createContainer(),this.notifications=new Map,this.nextId=1},[{key:"createContainer",value:function(){var t=document.querySelector(".ennu-notifications-container");return t||((t=document.createElement("div")).className="ennu-notifications-container",t.setAttribute("aria-live","polite"),t.setAttribute("aria-label","Notifications"),document.body.appendChild(t)),t}},{key:"show",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3,i=this.nextId++,o=this.createNotification(i,t,n);return this.container.appendChild(o),this.notifications.set(i,o),requestAnimationFrame(function(){o.classList.add("show")}),setTimeout(function(){e.hide(i)},a),"error"===n&&o.focus(),i}},{key:"createNotification",value:function(t,e,n){var a=this,i=document.createElement("div");return i.className="ennu-notification ennu-notification-".concat(n),i.setAttribute("role","error"===n?"alert":"status"),i.setAttribute("tabindex","-1"),i.innerHTML='\n            <div class="notification-content">\n                <div class="notification-icon" aria-hidden="true">\n                    '.concat(this.getIcon(n),'\n                </div>\n                <div class="notification-message">').concat(this.escapeHtml(e),'</div>\n                <button class="notification-close" aria-label="Close notification" type="button">\n                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16" aria-hidden="true">\n                        <line x1="18" y1="6" x2="6" y2="18"></line>\n                        <line x1="6" y1="6" x2="18" y2="18"></line>\n                    </svg>\n                </button>\n            </div>\n        '),i.querySelector(".notification-close").addEventListener("click",function(){return a.hide(t)}),i.addEventListener("keydown",function(e){"Escape"===e.key&&a.hide(t)}),i}},{key:"hide",value:function(t){var e=this,n=this.notifications.get(t);n&&(n.classList.remove("show"),n.classList.add("hiding"),setTimeout(function(){n.parentNode&&n.parentNode.removeChild(n),e.notifications.delete(t)},300))}},{key:"hideAll",value:function(){var t=this;this.notifications.forEach(function(e,n){t.hide(n)})}},{key:"getIcon",value:function(t){var e={success:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 6L9 17l-5-5"/></svg>',error:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>',warning:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>',info:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>'};return e[t]||e.info}},{key:"escapeHtml",value:function(t){var e=document.createElement("div");return e.textContent=t,e.innerHTML}}])}();document.addEventListener("DOMContentLoaded",function(){document.querySelector(".health-goals-grid")&&(window.ennuHealthGoalsManager=new r)})})();
//# sourceMappingURL=health-goals-manager.min.js.map